AVISO: Esse post é feito sem revisão ou supervisão de um adulto. Erros no meu entendimento sobre o assunto são esperados, estou escrevendo esses posts para registra meu aprendizado(ou tentativa de). Esses posts são pensando para quem já sabe programar e quer aprender ver sobre Nim, não para programadores de primeira viagem. Agradecimento e Créditos a Pamela Yeung Ribeiro por disponibilizar as artes para as capas.

Finalmente chegamos as coleções, no caso estarei cobrindo sobre Arrays, Sequencias(Seq) e Tuplas, suas utilidades, diferenças e diferentes formas de implementar. Após este post sairá outro desenvolvendo sobre Sequencias, que é um assunto que para cobrir melhor é necessário um post próprio.

1º — Arrays
Nim trata arrays segundo a definição, que pode ser resumido como uma sequencia não expansível de valores do mesmo tipo. Diferentemente de Python ou JavaScript, que optam por utilizar arrays de ponteiros ao invés dos tipos especifico, permitindo o mesmo array possui diferentes tipos, e que automaticamente é realocado caso seja preciso adicionar elementos, em Nim, isso não é possível, um Array criado com 40 espaços para inteiros, apenas pode receber 40 inteiros, e para aumentar seria preciso fazer manualmente a criação de um novo array, e copiar os valores. Para criar Arrays em Nim, basta indicar o seu tipo, tamanho, e, caso seja possível, indicar seus elementos na sua declaração. Você sim pode definir um array sem declarar seus valores, porem você não pode declarar apenas alguns valores, ou você diz todos, ou não diz nem um, em caso dos valores não serem declarados, um array de 20 espaços, será preenchido com 20 zeros. E como qualquer outro valor, você pode omitir a declaração de tipo e deixar o compilador trabalhar por você um pouco.

Outro ponto a se lembrar, o tamanho do array precisa ser definido em tempo de compilação, o que significa que não se pode esperar que o tamanho de um array seja dado durante a execução do programa. 

2º — Sequencias
Sequencias, são semelhantes a Arrays, com a diferença que uma sequencia pode ter seu tamanho expandido durante a execução do programa caso seja preciso. Existem algumas formas diferentes de se criar sequencias, a primeira é apenas declarando o seu tipo, isso ira gerar uma sequencia fazia que apenas recebe o tipo T; declarando seu tipo mais alguns valores ou apenas declarando os valores e deixar o compilador inferir o tipo, também se pode utilizar as funções newSeq e newSeqOfCap, que uma ira criar uma sequencia de tamanho L preenchida pelo valor zero do tipo, em caso de valores numéricos seriam uma sequencia preenchida por 0, e em caso de strings, strings vazias, enquanto newSeqOfCap, ira criar uma sequencia também de tamanho L, porem sem preencher os espaços.

Quando usar newSeq a newSeqOfCap ou simplesmente declara com seq[T], vai de caso pra caso, porem o resultado é que alocando uma sequencia com um tamanho especifico, adicionar novos elementos será mais rápido, pois não sera preciso alocar mais memória, e sim apenas alterar a já alocada. Eu pessoalmente não gosto muito de usar newSeq, pois ao adicionar elementos, o valor seria adicionado ao final da sequencia, enquanto com newSeqOfCap o valor vai para o começo, e eu pessoalmente não vejo muita utilidade em uma sequencia preenchida por zeros.

2.5 — Array 2 Seq
Um array é facilmente convertido para uma seq simplesmente utilizando o operador de @. Não existe uma forma padrão de converter uma sequencia para um array, então você teria que criar uma função própria para isso(farei isso em outro post).

3º — Diferença
O principal fator na hora de escolher entre array ou seq, é se soubermos ou não quantos elementos nos precisamos, caso soubermos, utilizamos arrays, pois no geral arrays são mais rápidos e fáceis do compilador lidar. A vantagem da seq é não ficarmos presos ao limite de tamanho do array, podendo adicionar e remover novos elementos, porem essa operação pode ser bem custosa, tornando o programa mais lento. E por ser raro sabermos exatamente quantos elementos nos precisamos, sequencias são costumeiramente mais utilizadas do que arrays, porem quando temos ao menos uma ideia de quanto espaços precisamos, podemos criar uma sequencia com newSeq/newSeqOfCap, assim no começo não teremos que alocar mais memória sempre que formos realizar uma adição a sequencia. 

4.1º — Slices e Indices
A forma com que os valores tanto em Arrays quanto em Sequencias são acessados e alterados são similares, ambos podem utilizar [índice] para acessar um valor especifico, ou [x..y] para acessar um slice(ou também conhecidos como fatias, ou range, ou pedaço, tem vários nomes). Utilização por índice é idêntico em ambos os casos, tanto, que se você ver solto sem ter visto a declaração não tem como saber se é um array ou seq rapidamente.

Lidando com slices/fatias/range/pedaço, é preciso pedir um espaço existente do array ou sequencia, caso você peça do índice 3 ao índice 9, porem a lista/seq so tenha 6 índices, o programa ira quebrar dando o famoso "index i out of bounds". Em arrays, caso você queira alterar um slice, é preciso passar um array com o mesmo tamanho do slice original. Porem lidando com sequencias, por eles terem tamanho mutável, você pode tanto dar uma sequencia menor ou maior do que a original, claro, passar uma seq muito maior do que o slice original poderá ser muito custoso, afinal será realocar os valores fora do slice junto a nova sequencia.

5º — Tuplas
Tupla é uma das minhas estruturas preferidas, especialmente em Nim. Para quem não conhece, tuplas são semelhantes a arrays no sentido de terem um tamanho fixo, com a diferença de que os seus valores podem ter tipos diferentes, e em Nim é possível dar nomes aos índices(similar a um JSON ou atributos de um objeto).

Esta na minha opinião, é forma correta de se utilizar tuplas, dando nomes aos índices, sim, você pode não dar nomes, e só utilizar os índices como em qualquer outra linguagem para acessar os valores, igual fosse um array, porem não existe motivo para você não dar nomes, não utilizar nomes ao ira tornar o uso das tuplas e a leitura do código mais complicado, pois uma das utilidades das tuplas, é justamente agrupar valores que possuem uma dependência, diferente de um array, como no caso a cima, a tupla representa um golpe chamado Gigaton Hammer, que seu poder é de 160, todo golpe possui um poder e um poder não relacionado a um golpe não tem utilidade, no exemplo comentado, esta a forma sem nomes. Sim, caso você queira não utilizar nomes você pode, o compilador não vai reclamar e ninguém vai invadir o seu quarto, te chamar de feio e chutar seu gato, fique a vontade para não utilizar nomes. Porem no geral, não utilizar nomes so tornara a leitura do código desnecessariamente mais complicada.

Você deve esta se perguntando: "Então tuplas são melhores que arrays?" e a resposta é não, tuplas possuem um usos específicos, comumente utilizadas como retorno de funções, para representar algo que possui diferentes valores que se relacionam, como pro exemplo, as 2 raízes de uma equação quadradica, como se fosse um pequeno objeto, Tuplas por serem uma estrutura simples porem flexível em seu conteúdo se torna uma ferramenta extremamente versátil em diferentes contextos, porem não podem substituir os arrays, chega a ser comigo pensar em utilizar tuplas com 400 valores.

7º — Papo furado
Aqui estamos, mais um post finalizado, este foi maiorzinho e eu ainda cortei muita coisa, no próximo post irei desenvolver sobre o uso de sequencias, nada muito complicado, apenas quis separa pois este post já estava ficando muito grande para o padrão do guia. Eu retornarei a falar sobre sequencias em breve após cobrir funções, além das coleções cobertas hoje ainda existem algumas outras, eu irei cobri-las no post após o seguinte, então esperem que logo sai. Por hoje é so, continuem estudando e nos ajudem a tornar Nim algo real no Brasil.